var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.createTemplateTagFirstArg=function(a){return a.raw=a};$jscomp.createTemplateTagFirstArgWithRaw=function(a,c){a.raw=c;return a};var ReferenceManagementController=function(){this._axiosInstance=axios.create({headers:{"X-CSRFToken":getCookie("csrftoken")}});this._formData=new FormData;this._maxFileSize=256E6;this._datatableObj=$("#reference-table");this._addEventsToDropZone();this._createReferenceTable()};
ReferenceManagementController.prototype._deleteReference=function(a){var c=this;this._axiosInstance["delete"]("/api/v1/reference",{data:{referencePk:a}}).then(function(b){alert(b.data);c._datatableObj.DataTable().ajax.reload(null,!1)})["catch"](function(b){console.error(b.response);alert("Reference failed to delete")})};
ReferenceManagementController.prototype._createReferenceTable=function(){var a=this;$.fn.DataTable.isDataTable(this._datatableObj)?this._datatableObj.DataTable().ajax.reload(null,!1):this._datatableObj.DataTable({createdRow:function(c,b,e,f){$(c).find(".ref-deletion").on("click",function(d){a._deleteReference(d.currentTarget.getAttribute("data-delete"))})},ajax:{url:"/api/v1/reference",async:!0,error:function(c,b,e){console.error(c);console.error(e)}},columnDefs:[{targets:0,data:"name"},{targets:1,
data:"length"},{targets:2,data:"private",render:function(c,b,e,f){return c["private"]?"Private":"Public"}},{width:"1.5rem",sortable:!1,targets:3,data:null,render:function(c,b,e,f){return c.deletable?'<a class="btn icon-task ref-deletion" data-delete="'+c.id+'"><i class="fa fa-minus-square"></i> Delete </a>':""}}]})};
ReferenceManagementController.prototype._addEventsToDropZone=function(){var a=this,c=$("#drop-zone");c.on("dragover",function(b){a._dragOverHandler(b)});c.on("dragleave",function(b){a._dragLeaveHandler(b)});c.on("dragenter",function(b){a._dragEnterHandler(b)});$("#reference-upload").on("change",function(b){for(var e=a._formData,f=0;f<b.currentTarget.files.length;f++){var d=b.currentTarget.files[f];d.size>a._maxFileSize&&a._modalError(d.name+" is too large ("+d.size+")! Upload refused.",3E3);e.append("file_location",
d,d.name);e.append("file_name",d.name)}axios({url:"/api/v1/reference/upload/",data:e,headers:{"X-CSRFToken":getCookie("csrftoken"),"Content-Type":"multipart/form-data; boundary="+e._boundary},onUploadProgress:function(g){var h=g.lengthComputable?g.total:g.target.getResponseHeader("content-length")||g.target.getResponseHeader("x-decompressed-content-length");null!==h&&$("#uploadProgressBar").css("width",Math.round(100*g.loaded/h)+"%");a._datatableObj.DataTable().ajax.reload(null,!1)},method:"post"}).then(function(g){a._formData=
new FormData;a._modalError("",0);a._datatableObj.DataTable().ajax.reload(null,!1)})["catch"](function(g){console.error(g);403===g.status&&a._modalError(g.response.data,6E3);a._formData=new FormData})})};
ReferenceManagementController.prototype._dropHandler=function(a){var c=this;a.preventDefault();a.stopImmediatePropagation();var b=this._formData;$("#drop-zone").removeClass("drop-zone-entered");$("#mdbup").html('<div class="progress" id="uploadProgress">\n          <div class="progress-bar progress-bar-striped progress-bar-animated" id="uploadProgressBar" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"></div>\n        </div>');if(a.dataTransfer.items){for(var e=0;e<a.dataTransfer.items.length;e++)if("file"===
a.dataTransfer.items[e].kind){var f=a.dataTransfer.items[e].getAsFile();f.size>this._maxFileSize&&this._modalError(f.name+" is too large ("+f.size+")! Upload refused.",3E3);b.append("file_location",f,f.name.replace(" ","_"));b.append("file_name",f.name.replace(" ","_"))}axios({url:"/api/v1/reference/upload/",data:b,headers:{"X-CSRFToken":getCookie("csrftoken"),"Content-Type":"multipart/form-data; boundary="+b._boundary},onUploadProgress:function(d){var g=d.lengthComputable?d.total:d.target.getResponseHeader("content-length")||
d.target.getResponseHeader("x-decompressed-content-length");null!==g&&$("#uploadProgressBar").css("width",Math.round(100*d.loaded/g)+"%")},method:"post"}).then(function(d){c._formData=new FormData;c._modalError("",0);c._datatableObj.DataTable().ajax.reload(null,!1)})["catch"](function(d){console.error(d);403===d.status&&c._modalError(d.response.data,6E3);c._formData=new FormData})}else{for(e=0;e<a.dataTransfer.files.length;e++)f=a.dataTransfer.items[e].getAsFile(),b.append("file_location",f,f.name.replace(" ",
"_")),b.append("filename",f.name.replace(" ","_"));axios({url:"/api/v1/reference/upload/",data:b,headers:{"X-CSRFToken":getCookie("csrftoken"),"Content-Type":"multipart/form-data; boundary="+b._boundary},method:"post"})}};
ReferenceManagementController.prototype._modalError=function(a,c){var b=this;a.length&&$("#mdbup").html('<span style="font-size: 2rem">'+a+"</span>");setTimeout(function(){$("#add-reference").modal("hide");$("#mdbup").html('<label id="drop-zone" class="dropzone" for="reference-upload">\n                        Drag and drop or click to upload ...\n                        </label>\n                        <input type="file" id="reference-upload" style="display: none"\n                           accept=".fsa,.fna,.fa,.fa.gz,.fsa.gz,.fna.gz" multiple>');b._addEventsToDropZone()},
c)};ReferenceManagementController.prototype._dragOverHandler=function(a){a.preventDefault();$(a.currentTarget).addClass("drop-zone-entered")};ReferenceManagementController.prototype._dragEnterHandler=function(a){$(a.currentTarget).addClass("drop-zone-entered")};ReferenceManagementController.prototype._dragLeaveHandler=function(a){$(a.currentTarget).removeClass("drop-zone-entered")};