{% load humanize %}

<div class="accordion" id="accordion">
    <div class="card card-primary card-outline">
        <div class="card-header">
            <h5>
                <button class="btn btn-link arrow-toggle" data-toggle="collapse" data-target="#collapseOne"
                        aria-expanded="true" aria-controls="collapseOne">
                    <i class="fas fa-table"></i>
                    All Reads Summary
                    <i class="fa fa-arrow-up"></i>
                    <i class="fa fa-arrow-down"></i>
                </button>
            </h5>
        </div>

        <div id="collapseOne" class="collapse show" aria-labelledby="headingOne" data-parent="#accordion">
            <div class="card-body">
                <table class="table table-hover">
                    <thead>
                    <th>Barcode</th>
                    <th>Read type</th>
                    <th>Rejection</th>
                    <th>Pass/Fail</th>
                    <th>Reads called</th>
                    <th>Yield</th>
                    <th>Percentage(bases)</th>
                    <th>Min read length</th>
                    <th>Average read length</th>
                    <th>Max read length</th>
                    <th>Average Quality</th>
                    </thead>
                    <tbody>

                    {% for record in qs|dictsortreversed:"read_type"|dictsort:"barcode_name" %}
                        {% if record.barcode_name == "All reads" %}

                            {% if record.read_type == "Pass" %}
                                <tr class="table-success">
                                    {% elif record.read_type == "Fail" %}
                                <tr class="table-danger">
                                    {% else %}
                                <tr class="table-info" style="font-weight:bold;font-style: italic">
                            {% endif %}
                        {% if record.read_type == "all" %}
                            <th>{{ record.barcode_name }}</th>
                            <th>{{ record.read_type_name }}</th>
                        {% else %}
                            <th></th>
                            <th></th>
                        {% endif %}
                        <th>{{ record.rejection_status }}</th>
                        <th>{{ record.read_type }}</th>
                        <th >{{ record.read_count|intcomma }}</th>
                        <th >{{ record.total_length|intcomma }}</th>
                        <th >{{ record.percentage|floatformat:"2" }}</th>
                        <th >{{ record.min_length|intcomma }}</th>
                        <th >{{ record.avg_length|floatformat:"0"|intcomma }}</th>
                        <th >{{ record.max_length|intcomma }}</th>
                        <th >{{ record.avg_quality|floatformat:"1" }}</th>
                        </tr>
                        {% endif %}
                    {% endfor %}

                    </tbody>


                </table>
            </div>
        </div>
    </div>
    {% if qs|length > 3 %}
        <div class="card card-primary card-outline">
            <div class="card-header" id="headingTwo">
                <h5>
                    <button class="btn btn-link collapsed arrow-toggle" data-toggle="collapse"
                            data-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
                        <i class="fas fa-table"></i>
                        Read Summary by Barcode
                        <i class="fa fa-arrow-up"></i>
                        <i class="fa fa-arrow-down"></i>
                    </button>
                </h5>
            </div>
            <div id="collapseTwo" class="collapse" aria-labelledby="headingTwo" data-parent="#accordion">
                <div class="card-body">
                    <table id="barcode_table" class="table table-hover">
                        <thead>
                        <tr>
                            <th>Barcode</th>
                            <th>Read type</th>
                            <th>Rejection</th>
                            <th>Pass/Fail</th>
                            <th>Reads called</th>
                            <th>Yield</th>
                            <th>Percentage(bases)</th>
                            <th>Min read length</th>
                            <th>Average read length</th>
                            <th>Max read length</th>
                            <th>Average Quality</th>
                        </tr>
                        </thead>
                        <tbody>
                        {% for record in qs|dictsortreversed:"read_type"|dictsort:"barcode_name" %}
                            {% if record.barcode_name != "All reads" %}

                                {% if record.read_type == "Pass" %}
                                    <tr class="table-success">
                                        {% elif record.read_type == "Fail" %}
                                    <tr class="table-danger">
                                        {% else %}
                                    <tr class="table-info" style="font-weight:bold;font-style: italic">
                                {% endif %}
                            {% if record.read_type == "all" %}
                                <th>{{ record.barcode_name }}</th>
                                <th>{{ record.read_type_name }}</th>
                            {% else %}
                                <th></th>
                                <th></th>
                            {% endif %}
                            <th>{{ record.rejection_status }}</th>

                            <th>{{ record.read_type }}</th>
                            <th>{{ record.read_count|intcomma }}</th>
                            <th>{{ record.total_length|intcomma }}</th>
                            <th>{{ record.percentage|floatformat:"2" }}</th>
                            <th>{{ record.min_length|intcomma }}</th>
                            <th>{{ record.avg_length|floatformat:"0"|intcomma }}</th>
                            <th>{{ record.max_length|intcomma }}</th>
                            <th>{{ record.avg_quality|floatformat:"1" }}</th>
                            </tr>
                            {% endif %}
                        {% endfor %}

                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    {% endif %}
</div>


{% block javascript %}
    <script>
      //$(document).ready(function () {
      //    $('#barcode_table').DataTable();
      //});

    </script>
{% endblock %}
